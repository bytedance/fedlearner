load("@rules_python//python:defs.bzl", "py_library")

package(default_visibility = ["//web_console_v2/api:console_api_package"])

py_library(
    name = "job_configer",
    srcs = [
        "analyzer_configer.py",
        "base_configer.py",
        "data_alignment_configer.py",
        "dataset_job_configer.py",
        "export_configer.py",
        "hash_data_join_configer.py",
        "import_source_configer.py",
        "light_client_ot_psi_data_join_configer.py",
        "light_client_rsa_psi_data_join_configer.py",
        "ot_psi_data_join_configer.py",
        "rsa_psi_data_join_configer.py",
    ],
    data = [
        "//web_console_v2/api/fedlearner_webconsole/sys_preset_templates",
    ],
    imports = ["../../.."],
    deps = [
        "//web_console_v2/api/fedlearner_webconsole:exceptions_lib",
        "//web_console_v2/api/fedlearner_webconsole/dataset:common_lib",
        "//web_console_v2/api/fedlearner_webconsole/dataset:data_path_lib",
        "//web_console_v2/api/fedlearner_webconsole/dataset:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/setting:service_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:domain_name_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:file_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:schema_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:workflow_lib",
        "//web_console_v2/api/fedlearner_webconsole/workflow_template:service_lib",
        "//web_console_v2/api/fedlearner_webconsole/workflow_template:utils_lib",
        "//web_console_v2/api/protocols/fedlearner_webconsole/proto:py_proto",
        "@com_google_protobuf//:protobuf_python",
        "@common_rsa//:pkg",
        "@common_sqlalchemy//:pkg",
    ],
)

py_test(
    name = "dataset_job_configer_test",
    size = "medium",
    srcs = [
        "dataset_job_configer_test.py",
    ],
    imports = ["../../.."],
    main = "dataset_job_configer_test.py",
    deps = [
        ":job_configer",
        "//web_console_v2/api/fedlearner_webconsole:db_lib",
        "//web_console_v2/api/fedlearner_webconsole:initial_db_lib",
        "//web_console_v2/api/fedlearner_webconsole/dataset:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/project:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:resource_name_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:workflow_lib",
        "//web_console_v2/api/protocols/fedlearner_webconsole/proto:py_proto",
        "//web_console_v2/api/testing:no_web_server_test_case_lib",
        "@com_google_protobuf//:protobuf_python",
    ],
)

py_test(
    name = "light_client_ot_psi_data_join_configer_test",
    size = "small",
    srcs = [
        "light_client_ot_psi_data_join_configer_test.py",
    ],
    imports = ["../../.."],
    main = "light_client_ot_psi_data_join_configer_test.py",
    deps = [
        ":job_configer",
        "//web_console_v2/api/fedlearner_webconsole:db_lib",
        "//web_console_v2/api/fedlearner_webconsole:initial_db_lib",
        "//web_console_v2/api/fedlearner_webconsole/dataset:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/project:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:resource_name_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:workflow_lib",
        "//web_console_v2/api/protocols/fedlearner_webconsole/proto:py_proto",
        "//web_console_v2/api/testing:no_web_server_test_case_lib",
        "@com_google_protobuf//:protobuf_python",
    ],
)

py_test(
    name = "export_configer_test",
    size = "small",
    srcs = [
        "export_configer_test.py",
    ],
    imports = ["../../.."],
    main = "export_configer_test.py",
    deps = [
        ":job_configer",
        "//web_console_v2/api/fedlearner_webconsole:db_lib",
        "//web_console_v2/api/fedlearner_webconsole:initial_db_lib",
        "//web_console_v2/api/fedlearner_webconsole/dataset:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/project:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:resource_name_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:workflow_lib",
        "//web_console_v2/api/protocols/fedlearner_webconsole/proto:py_proto",
        "//web_console_v2/api/testing:no_web_server_test_case_lib",
        "@com_google_protobuf//:protobuf_python",
    ],
)

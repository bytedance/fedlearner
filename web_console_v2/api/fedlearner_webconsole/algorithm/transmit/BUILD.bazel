load("@rules_python//python:defs.bzl", "py_library")

package(default_visibility = ["//web_console_v2/api:console_api_package"])

py_library(
    name = "transmit",
    srcs = [
        "hash.py",
        "receiver.py",
        "sender.py",
    ],
    imports = ["../../.."],
    deps = [
        "//web_console_v2/api/fedlearner_webconsole/algorithm:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/algorithm:utils_lib",
        "//web_console_v2/api/fedlearner_webconsole/utils:file_lib",
        "//web_console_v2/api/protocols/fedlearner_webconsole/proto:py_proto",
        "//web_console_v2/api/protocols/fedlearner_webconsole/proto/rpc/v2:py_proto",
    ],
)

py_test(
    name = "hash_test",
    srcs = [
        "hash_test.py",
    ],
    imports = ["../../.."],
    deps = [
        ":transmit",
        "//web_console_v2/api/fedlearner_webconsole/utils:file_lib",
    ],
)

py_test(
    name = "sender_test",
    srcs = [
        "sender_test.py",
    ],
    data = [
        "//web_console_v2/api/testing/test_data/algorithm",
    ],
    imports = ["../../.."],
    deps = [
        ":transmit",
        "//web_console_v2/api:envs_lib",
        "//web_console_v2/api/testing:common_lib",
    ],
)

py_test(
    name = "receiver_test",
    srcs = [
        "receiver_test.py",
    ],
    data = [
        "//web_console_v2/api/testing/test_data/algorithm",
    ],
    imports = ["../../.."],
    deps = [
        ":transmit",
        "//web_console_v2/api:envs_lib",
        "//web_console_v2/api/fedlearner_webconsole:db_lib",
        "//web_console_v2/api/fedlearner_webconsole/algorithm:models_lib",
        "//web_console_v2/api/fedlearner_webconsole/algorithm:utils_lib",
        "//web_console_v2/api/protocols/fedlearner_webconsole/proto:py_proto",
        "//web_console_v2/api/testing:common_lib",
        "@com_google_protobuf//:protobuf_python",
    ],
)
